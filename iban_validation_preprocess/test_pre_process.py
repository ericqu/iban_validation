import os
import pre_process_registry as ppr


def test_preprocess():
    inputfile = 'iban_validation_preprocess/iban_registry_v99.txt'
    output_iban_file = 'iban_validation_preprocess/test_out.json'

    df = ppr.pre_process(inputfile, output_iban_file)

    target_list = [[65, 68], [65, 69], [65, 76], [65, 84], [65, 90], [66, 65], [66, 69], [66, 71], [66, 72], [66, 73], [66, 82], [66, 89], [67, 72], [67, 82], [67, 89], [67, 90], [68, 69], [68, 74], [68, 75], [68, 79], [69, 69], [69, 71], [69, 83], [70, 73], [70, 75], [70, 79], [70, 82], [71, 66], [71, 69], [71, 73], [71, 76], [71, 82], [71, 84], [72, 78], [72, 82], [72, 85], [73, 69], [73, 76], [73, 81], [73, 83], [73, 84], [74, 79], [75, 87], [75, 90], [76, 66], [76, 67], [76, 73], [76, 84], [76, 85], [76, 86], [76, 89], [77, 67], [77, 68], [77, 69], [77, 75], [77, 78], [77, 82], [77, 84], [77, 85], [78, 73], [78, 76], [78, 79], [79, 77], [80, 75], [80, 76], [80, 83], [80, 84], [81, 65], [82, 79], [82, 83], [82, 85], [83, 65], [83, 67], [83, 68], [83, 69], [83, 73], [83, 75], [83, 77], [83, 79], [83, 84], [83, 86], [84, 76], [84, 78], [84, 82], [85, 65], [86, 65], [86, 71], [88, 75], [89, 69]]
    ctryl = df['ctry_cd'].to_list()

    assert (target_list == ctryl)

    try:
        os.remove(output_iban_file)
    except OSError:
        pass
